new code with improved mistakes